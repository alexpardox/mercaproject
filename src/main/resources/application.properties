# Configuración de la aplicación
spring.application.name=merca

# =========================================
# CONFIGURACIÓN DE BASE DE DATOS POSTGRESQL (SUPABASE)
# =========================================

# Conexión a PostgreSQL en Supabase usando variables de entorno
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Pool de conexiones optimizado para Supabase
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=30000

# Configuración de JPA/Hibernate para PostgreSQL
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# Configuración específica para ENUMs de PostgreSQL
spring.jpa.properties.hibernate.type.preferred_uuid_jdbc_type=VARCHAR
spring.jpa.properties.hibernate.type.preferred_enum_jdbc_type=NAMED
spring.jpa.properties.hibernate.type.enums_as_names=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Configuración de Thymeleaf
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html

# Configuración del servidor
server.port=${SERVER_PORT:8080}
server.servlet.context-path=${SERVER_CONTEXT_PATH:/mercadia}

# Configuración de la aplicación
# Configuración de inicialización de datos  
app.initialize-data=${APP_INITIALIZE_DATA:true}

# Configuración de logging
logging.level.com.merca.merca=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=INFO

# Configuración de sesiones seguras
server.servlet.session.timeout=${SESSION_TIMEOUT:30m}
server.servlet.session.cookie.name=${SESSION_COOKIE_NAME:MERCADIA_SESSION}
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=strict

# Configuración de archivos estáticos
spring.web.resources.static-locations=classpath:/static/

# =============================================
# CONFIGURACIÓN PARA DESARROLLO LOCAL H2 (DESHABILITADA)
# La aplicación ahora usa únicamente PostgreSQL de Supabase
# =============================================

# Para volver a desarrollo con H2, descomenta estas líneas y comenta la configuración PostgreSQL:
# spring.datasource.url=jdbc:h2:mem:mercadia
# spring.datasource.driver-class-name=org.h2.Driver
# spring.datasource.username=sa
# spring.datasource.password=
# spring.h2.console.enabled=true
# spring.h2.console.path=/h2-console
# spring.jpa.hibernate.ddl-auto=create-drop
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# =============================================
# NOTAS IMPORTANTES:
# =============================================
# 1. La aplicación ahora usa ÚNICAMENTE PostgreSQL de Supabase
# 2. Las credenciales se cargan desde el archivo .env
# 3. Asegúrate de ejecutar el script SQL en Supabase antes del primer uso
# 4. Para ejecutar: mvn spring-boot:run